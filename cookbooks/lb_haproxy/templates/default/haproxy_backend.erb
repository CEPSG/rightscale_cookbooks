backend <%= @backend_name_line %>

<%  if @userlist_pool_name != "" %>
        acl Auth_<%=@userlist_pool_name%> http_auth(UsersFor_<%=@userlist_pool_name%>)
        http-request auth realm Please_enter_your_credentials if !Auth_<%=@userlist_pool_name%>
<%  end %>

        mode http
        balance roundrobin

        # Haproxy status page
        <%= @stats_uri_line %>
        <%= @stats_auth_line %>

        # when cookie persistence is required
        cookie SERVERID insert indirect nocache

        # When internal servers support a status page
        <%= @health_uri_line %>
        <%= @health_check_line %>

        # Special server line that allow HAProxy to start with cookies enabled and no valid servers.
        server disabled-server 127.0.0.1:1 disabled

